<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Créateur de CV IA - Pro Recruteur</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Montserrat:wght@400;500;700;800&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Roboto+Mono:wght@400;700&family=Merriweather:wght@400;700&family=Oswald:wght@400;700&family=Cormorant+Garamond:wght@400;700&family=Open+Sans:wght@400;700&family=Source+Sans+Pro:wght@400;700&family=Nunito+Sans:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    
    <style>
        :root {
            --page-margin: 2cm;
            --primary-color: #2563eb;
            --secondary-color: #334155;
            --body-text-color: #334155;
            --font-family-h1: 'Montserrat', sans-serif;
            --font-family-h2: 'Montserrat', sans-serif;
            --font-family-body: 'Lato', sans-serif;
            --font-size-h1: 40pt;
            --font-size-h2: 21pt;
            --font-size-p: 10pt;
            --font-size-banner: 9pt;
            --line-height: 1.6;
            --paragraph-spacing: 0.5rem;
            --module-spacing: 1.5rem;
            --item-spacing: 0.5rem;
            --banner-element-spacing: 1rem;
        }

        #cv-preview-wrapper { width: 100%; display: flex; flex-direction: column; align-items: center; gap: 20px; }
        .a4-page-container { position: relative; }
        /* CORRECTIF : Remplacement de min-height par height pour une détection de dépassement fiable */
        .a4-page { width: 21cm; height: 29.7cm; box-shadow: 0 10px 30px rgba(0,0,0,0.15); background-color: white; overflow: hidden; display: flex; flex-direction: column; transition: all 0.3s ease; font-family: var(--font-family-body); color: var(--body-text-color); position: relative; outline: 2px solid transparent; outline-offset: -2px; padding: var(--page-margin); box-sizing: border-box; }
        body.overflow-check-active .is-overflowing { outline: 3px solid #ef4444 !important; box-shadow: 0 0 20px 8px rgba(239, 68, 68, 0.3) !important; }
        
        .remove-page-btn { position: absolute; top: -10px; right: -10px; width: 30px; height: 30px; background-color: #ef4444; color: white; border: none; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; opacity: 0.5; transition: opacity 0.2s, transform 0.2s; z-index: 10; }
        .remove-page-btn:hover { opacity: 1; transform: scale(1.1); }
        .a4-page-container:first-child .remove-page-btn { display: none; }

        #add-page-btn-wrapper { width: 21cm; text-align: center; padding: 10px 0; }
        #add-page-btn { width: 50px; height: 50px; background-color: #3b82f6; color: white; border-radius: 50%; border: none; cursor: pointer; font-size: 24px; transition: transform 0.2s; }
        #add-page-btn:hover { transform: scale(1.1); }

        .cv-body-container { display: grid; gap: 1rem; height: 100%; flex-grow: 1; position: relative; }
        .layout-1-col { grid-template-columns: 1fr; }
        .layout-2-col-33-67 { grid-template-columns: 1fr 2fr; }
        .layout-2-col-50-50 { grid-template-columns: 1fr 1fr; }
        .layout-2-col-67-33 { grid-template-columns: 2fr 1fr; }

        .cv-column { min-height: 150px; height: 100%; border: 1px dotted #ccc; padding: 5px; }
        .cv-module { position: relative; margin-bottom: var(--module-spacing); }
        .cv-module .drag-handle { position: absolute; top: 10px; left: -25px; cursor: grab; color: #d1d5db; opacity: 0; transition: opacity 0.2s; font-size: 1.2rem; }
        .cv-module:hover .drag-handle { opacity: 1; }
        .sortable-ghost { opacity: 0.4; background: #cce7ff; border: 1px dashed var(--primary-color); }

        [contenteditable="true"]:hover { outline: 1px dashed #3b82f6; background-color: #eff6ff; }
        [contenteditable="true"]:focus { outline: 2px solid #3b82f6; background-color: #dbeafe; }

        .cv-header h1 { font-family: var(--font-family-h1); font-weight: 800; font-size: var(--font-size-h1); color: var(--primary-color); margin-bottom: 0.25rem; }
        .cv-header p { font-family: var(--font-family-body); font-size: 1.2rem; color: var(--secondary-color); }
        .section-title { font-family: var(--font-family-h2); font-weight: 700; font-size: var(--font-size-h2); margin-bottom: 0.8rem; padding-bottom: 0.4rem; color: var(--primary-color); display: flex; align-items: center; gap: 0.5rem; transition: opacity 0.3s; }
        .section-title.style-underline { border-bottom: 2px solid var(--primary-color); }
        .section-title.style-side-line { border-left: 4px solid var(--primary-color); border-bottom: none; padding-left: 0.5rem; }
        .section-title.style-background { background-color: var(--primary-color); color: white; padding: 0.3rem 0.6rem; margin-bottom: 1rem; border-radius: 0.25rem; }
        .section-title.style-background .section-icon { color: white !important; }
        .section-title.style-boxed { border: 2px solid var(--primary-color); padding: 0.3rem 0.6rem; }

        .section-title .section-icon { cursor: pointer; transition: transform 0.2s; }
        .section-title .section-icon:hover { transform: scale(1.1); }
        .a4-page p, .a4-page li, #cv-description-preview, #cv-experience-preview, #cv-formation-preview { font-size: var(--font-size-p); line-height: var(--line-height); }
        .a4-page p { margin-bottom: var(--paragraph-spacing); }
        .a4-page ul { list-style: none; padding-left: 0;}
        #cv-competences-preview[data-style="simple"] ul li,
        .a4-page ul li { padding-left: 1.4em; position: relative; margin-bottom: 0.25rem; }
        #cv-competences-preview[data-style="simple"] ul li::before,
        .a4-page ul li::before { content: '›'; font-weight: bold; position: absolute; left: 0; color: var(--primary-color); font-size: 1.2em; top: -0.1em; }
        
        .item-title { font-weight: 700; color: var(--secondary-color); }
        .item-meta { font-size: calc(var(--font-size-p) * 0.9); font-style: italic; }

        #recruiter-banner { display: flex; align-items: center; padding: 0.5rem; box-sizing: border-box; width: 100%; font-size: var(--font-size-banner); position: relative; overflow: hidden; }
        .banner-content-wrapper { position: relative; z-index: 1; display: flex; align-items: center; width: 100%; height: 100%; gap: var(--banner-element-spacing); }
        #banner-bg-img-preview { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 0; transition: opacity 0.3s, filter 0.3s; }
        #fixed-banner-top { margin-bottom: var(--module-spacing); display: none; }
        #fixed-banner-bottom { margin-top: auto; padding-top: var(--module-spacing); display: none; }
        #banner-img-preview { border-radius: 50%; object-fit: cover; flex-shrink: 0; transition: width 0.3s, height 0.3s; background-color: rgba(255,255,255,0.5); }
        #banner-img-preview.logo-sm { width: 40px; height: 40px; }
        #banner-img-preview.logo-md { width: 60px; height: 60px; }
        #banner-img-preview.logo-lg { width: 80px; height: 80px; }
        #banner-img-preview.logo-xl { width: 100px; height: 100px; }
        #banner-img-preview.logo-xxl { width: 120px; height: 120px; }
        #banner-nom-preview { font-weight: 700; }
        .banner-align-left { justify-content: flex-start; text-align: left; }
        .banner-align-center { justify-content: center; text-align: center; }
        .banner-align-right { justify-content: flex-end; text-align: right; }
        .banner-layout-inverted { flex-direction: row-reverse; }
        .banner-style-elegant { border-top: 2px solid var(--primary-color); border-bottom: 2px solid var(--primary-color); background: transparent; }
        .banner-style-modern { background-color: var(--primary-color); color: white; border-radius: 0.5rem; }
        .banner-style-modern p, .banner-style-modern span { color: white !important; }
        .banner-style-discret { border-left: 4px solid #d1d5db; background: transparent; }
        .banner-style-carte { box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); border-radius: 0.5rem; background: #f9fafb; }
        .banner-style-degrade { background: linear-gradient(to right, var(--primary-color), #a5b4fc); color: white; border-radius: 0.5rem; }
        .banner-style-degrade p, .banner-style-degrade span { color: white !important; }
        .banner-style-premium { background-color: #1e293b; color: #fde68a; border: 1px solid #fde68a; border-radius: 0.25rem; }
        .banner-style-premium p, .banner-style-premium span { color: #f1f5f9 !important; }
        .banner-style-minimal { border-bottom: 2px solid var(--primary-color); }
        .banner-style-encadre { border: 2px solid var(--primary-color); border-radius: 0.5rem; }
        .banner-style-ligne-haute { border-top: 4px solid var(--primary-color); padding-top: 0.8rem !important; }

        /* === SYSTÈME DE NOTIFICATIONS MODERNE === */
        #notification-container { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            z-index: 10000; 
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-width: 400px;
            pointer-events: none;
        }
        
        .toast { 
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            color: #1f2937; 
            padding: 16px 20px; 
            border-radius: 12px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.1), 0 4px 10px rgba(0,0,0,0.05);
            display: flex; 
            align-items: center; 
            gap: 12px; 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            transform: translateX(120%) scale(0.95);
            opacity: 0;
            border: 1px solid rgba(0,0,0,0.05);
            backdrop-filter: blur(10px);
            pointer-events: auto;
            position: relative;
            overflow: hidden;
            min-width: 320px;
        }
        
        .toast::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--toast-color, #10b981), var(--toast-color-light, #34d399));
        }
        
        .toast.show { 
            transform: translateX(0) scale(1);
            opacity: 1;
        }
        
        .toast.success {
            --toast-color: #10b981;
            --toast-color-light: #34d399;
            border-left: 4px solid #10b981;
        }
        
        .toast.error {
            --toast-color: #ef4444;
            --toast-color-light: #f87171;
            border-left: 4px solid #ef4444;
        }
        
        .toast.warning {
            --toast-color: #f59e0b;
            --toast-color-light: #fbbf24;
            border-left: 4px solid #f59e0b;
        }
        
        .toast.info {
            --toast-color: #3b82f6;
            --toast-color-light: #60a5fa;
            border-left: 4px solid #3b82f6;
        }
        
        .toast-icon {
            font-size: 20px;
            flex-shrink: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .toast.success .toast-icon { color: #10b981; }
        .toast.error .toast-icon { color: #ef4444; }
        .toast.warning .toast-icon { color: #f59e0b; }
        .toast.info .toast-icon { color: #3b82f6; }
        
        .toast-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .toast-title {
            font-weight: 600;
            font-size: 14px;
            line-height: 1.2;
        }
        
        .toast-message {
            font-size: 13px;
            opacity: 0.8;
            line-height: 1.3;
        }
        
        .toast-close {
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }
        
        .toast-close:hover {
            background: rgba(0,0,0,0.05);
            color: #374151;
        }
        
        .toast-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 2px;
            background: var(--toast-color, #10b981);
            transition: width linear;
            opacity: 0.6;
        }

        /* Styles for collapsible control panel sections */
        details.control-group {
            background-color: #f9fafb;
            border: 1px solid #f3f4f6;
            border-radius: 0.5rem;
            transition: background-color 0.2s;
        }
        details.control-group[open] {
            background-color: white;
            border-color: #e5e7eb;
        }
        details.control-group summary {
            list-style: none;
            cursor: pointer;
            padding: 1rem;
            font-weight: 600;
            color: #374151;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        details.control-group summary::-webkit-details-marker {
            display: none;
        }
        details.control-group .control-group-content {
            padding: 0 1rem 1rem 1rem;
            border-top: 1px solid #f3f4f6;
            margin-top: -0.5rem;
            padding-top: 1rem;
        }
        .completion-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
            font-weight: 400;
            color: #6b7280;
            cursor: pointer;
        }
        .completion-checkbox {
            height: 1rem;
            width: 1rem;
            border-radius: 0.25rem;
            border-color: #d1d5db;
            color: #4f46e5;
            cursor: pointer;
        }
        .completion-checkbox:focus {
            outline: 2px solid #4f46e5;
            outline-offset: 2px;
        }
        
        
        /* --- Specific styles for skills section --- */
        #cv-competences-preview h3.skill-category { font-family: var(--font-family-h2); font-weight: 700; color: var(--secondary-color); margin-top: 0.8rem; margin-bottom: 0.4rem; padding-bottom: 0.2rem; border-bottom: 1px solid #e5e7eb; font-size: calc(var(--font-size-p) * 1.05); text-transform: uppercase; letter-spacing: 0.5px; }
        #cv-competences-preview .skill-category:hover { background-color: #f3f4f6; }
        #cv-competences-preview[data-style="tags"] ul { padding-left: 0; list-style: none; margin-top: 0.25rem; margin-bottom: 0.5rem; line-height: 1.5; }
        #cv-competences-preview[data-style="tags"] ul li.skill-item { display: inline-block; margin: 0 8px 6px 0; padding: 3px 20px 3px 10px; border-radius: 12px; background-color: #f3f4f6; font-size: calc(var(--font-size-p) * 0.95); position: relative; cursor: grab; }
        #cv-competences-preview[data-style="tags"] ul li.skill-item:hover { background-color: #e5e7eb; }
        #cv-competences-preview[data-style="tags"] ul li::before { content: none; }
        .skills-ghost { opacity: 0.4; background: #cce7ff; border-radius: 12px; }

        /* Styles pour les options de mise en page avancées */
        .layout-control-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            align-items: center;
        }
        .layout-control-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }
        .control-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .control-item label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
        }
        .control-item input[type="range"] {
            width: 100%;
            accent-color: var(--primary-color);
        }
        .control-item input[type="color"] {
            width: 50px;
            height: 32px;
            border: none;
            border-radius: 0.25rem;
            cursor: pointer;
        }
        .range-value {
            font-size: 0.75rem;
            color: #6b7280;
            text-align: center;
        }
        .button-group {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        .button-group button {
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 0.25rem;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.2s;
        }
        .button-group button:hover {
            background: #f3f4f6;
        }
        .button-group button.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.5rem;
        }
        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            font-size: 0.875rem;
        }
        .pattern-preview {
            width: 30px;
            height: 30px;
            border: 1px solid #d1d5db;
            border-radius: 0.25rem;
            margin-left: 0.5rem;
        }
        .shape-preview {
            width: 40px;
            height: 30px;
            border: 1px solid #d1d5db;
            margin-left: 0.5rem;
            display: inline-block;
        }
        .animation-preview {
            width: 20px;
            height: 20px;
            background: var(--primary-color);
            margin-left: 0.5rem;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes float {
            0% {
                transform: translateY(0px) rotate(0deg);
                opacity: 0.8;
            }
            33% {
                transform: translateY(-10px) rotate(120deg);
                opacity: 1;
            }
            66% {
                transform: translateY(5px) rotate(240deg);
                opacity: 0.9;
            }
            100% {
                transform: translateY(0px) rotate(360deg);
                opacity: 0.8;
            }
        }

        /* Classes CSS pour les effets de mise en page */
        .bg-solid { background-color: var(--bg-color, #ffffff); }
        .bg-gradient-linear { background: linear-gradient(var(--gradient-direction, to right), var(--gradient-color1, #ffffff), var(--gradient-color2, #f3f4f6)); }
        .bg-gradient-radial { background: radial-gradient(circle, var(--gradient-color1, #ffffff), var(--gradient-color2, #f3f4f6)); }
        .bg-pattern-dots { background-image: radial-gradient(circle, var(--pattern-color, #e5e7eb) 1px, transparent 1px); background-size: 20px 20px; }
        .bg-pattern-lines { background-image: linear-gradient(90deg, var(--pattern-color, #e5e7eb) 1px, transparent 1px); background-size: 20px 20px; }
        .bg-pattern-grid { background-image: linear-gradient(var(--pattern-color, #e5e7eb) 1px, transparent 1px), linear-gradient(90deg, var(--pattern-color, #e5e7eb) 1px, transparent 1px); background-size: 20px 20px; }
        .bg-texture-paper { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><defs><filter id="noise"><feTurbulence baseFrequency="0.9" numOctaves="1" seed="1"/><feComponentTransfer><feFuncA type="discrete" tableValues="0 .5 0 1 0 .5 0 1"/></feComponentTransfer></filter></defs><rect width="100%" height="100%" filter="url(%23noise)" opacity="0.03"/></svg>'); }
        .bg-texture-fabric { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"><rect width="40" height="40" fill="white"/><path d="M0 0h40v40H0z" fill="none" stroke="rgba(0,0,0,0.05)" stroke-width="0.5"/></svg>'); }
        
        .border-style-solid { border-style: solid; }
        .border-style-dashed { border-style: dashed; }
        .border-style-dotted { border-style: dotted; }
        .border-style-double { border-style: double; }
        
        .shadow-soft { box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); }
        .shadow-medium { box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        .shadow-strong { box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1); }
        .shadow-colored { box-shadow: 0 4px 6px rgba(var(--shadow-color-rgb), 0.2); }
        .shadow-inset { box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1); }
        
        .shape-rectangle { border-radius: 0; }
        .shape-rounded { border-radius: 0.5rem; }
        .shape-circle { border-radius: 50%; }
        .shape-pill { border-radius: 50px; }
        .shape-custom { border-radius: var(--custom-radius, 0.5rem); }
        
        .text-align-left { text-align: left; }
        .text-align-center { text-align: center; }
        .text-align-right { text-align: right; }
        .text-align-justify { text-align: justify; }
        
        .animation-fade-in { animation: fadeIn 1s ease-in; }
        .animation-slide-in { animation: slideIn 0.5s ease-out; }
        .animation-zoom-in { animation: zoomIn 0.3s ease-out; }
        .animation-bounce { animation: bounce 0.6s ease-out; }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes zoomIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        .filter-blur { filter: blur(2px); }
        .filter-brightness { filter: brightness(1.2); }
        .filter-contrast { filter: contrast(1.2); }
        .filter-grayscale { filter: grayscale(0.5); }
        .filter-sepia { filter: sepia(0.3); }

        /* Animations personnalisées */
        @keyframes fade {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slide {
            from { transform: translateY(-10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-5px); }
            60% { transform: translateY(-2px); }
        }
        @keyframes scale {
            from { transform: scale(0.95); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        /* Styles d'impression */
        .print-optimized {
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
        .high-contrast-print {
            filter: contrast(1.5);
        }

        @media print {
            .print-optimized {
                box-shadow: none !important;
                animation: none !important;
            }
            .high-contrast-print {
                background: white !important;
                color: black !important;
            }
        }

        /* Style pour le bouton réduire tout */
        #collapse-all-btn {
            transition: all 0.2s ease;
            border: 1px solid #e5e7eb;
        }
        #collapse-all-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        #collapse-all-btn:active {
            transform: translateY(0);
        }

        /* Animations IA stylées */
        .ai-thinking-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
            backdrop-filter: blur(8px);
        }

        .ai-thinking-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        /* Animation de restructuration spectaculaire */
        .cv-restructure-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(59, 130, 246, 0.95), rgba(139, 92, 246, 0.95));
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .cv-restructure-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .cv-restructure-container {
            text-align: center;
            color: white;
            max-width: 800px;
            width: 90%;
        }

        .restructure-title {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 2rem;
            animation: titlePulse 2s ease-in-out infinite;
        }

        .letters-container {
            position: relative;
            height: 400px;
            overflow: hidden;
            margin: 2rem 0;
        }

        .flying-letter {
            position: absolute;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            opacity: 0.9;
            animation: flyAndRestructure 4s ease-in-out;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .building-element {
            position: absolute;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.4);
            animation: buildUp 0.8s ease-out forwards;
            transform: scale(0) rotate(45deg);
            opacity: 0;
        }

        .progress-text {
            font-size: 1.2rem;
            margin-top: 2rem;
            animation: textFade 3s ease-in-out infinite;
        }

        .magic-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            animation: magicParticle 3s ease-out infinite;
            opacity: 0;
        }

        @keyframes titlePulse {
            0%, 100% { transform: scale(1); text-shadow: 0 0 20px rgba(255, 255, 255, 0.5); }
            50% { transform: scale(1.05); text-shadow: 0 0 30px rgba(255, 255, 255, 0.8); }
        }

        @keyframes flyAndRestructure {
            0% {
                transform: translate(0, 0) rotate(0deg) scale(1);
                opacity: 1;
            }
            20% {
                transform: translate(var(--random-x, 200px), var(--random-y, -150px)) rotate(var(--random-rotation, 180deg)) scale(1.2);
                opacity: 0.8;
            }
            40% {
                transform: translate(var(--random-x2, -150px), var(--random-y2, 100px)) rotate(var(--random-rotation2, -90deg)) scale(0.8);
                opacity: 0.6;
            }
            60% {
                transform: translate(var(--random-x3, 100px), var(--random-y3, -50px)) rotate(var(--random-rotation3, 270deg)) scale(1.5);
                opacity: 0.9;
            }
            80% {
                transform: translate(var(--final-x, 0px), var(--final-y, 50px)) rotate(720deg) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--final-x, 0px), var(--final-y, 50px)) rotate(0deg) scale(1);
                opacity: 1;
            }
        }

        @keyframes buildUp {
            0% {
                transform: scale(0) rotate(45deg);
                opacity: 0;
            }
            50% {
                transform: scale(1.2) rotate(22.5deg);
                opacity: 0.8;
            }
            100% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        @keyframes textFade {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        @keyframes magicParticle {
            0% {
                transform: translate(0, 0) scale(0);
                opacity: 0;
            }
            20% {
                transform: translate(var(--particle-x, 50px), var(--particle-y, -30px)) scale(1);
                opacity: 1;
            }
            80% {
                transform: translate(var(--particle-x2, -30px), var(--particle-y2, 20px)) scale(0.5);
                opacity: 0.5;
            }
            100% {
                transform: translate(var(--particle-x3, 100px), var(--particle-y3, -100px)) scale(0);
                opacity: 0;
            }
        }

        /* Animations supplémentaires pour un effet spectaculaire */
        .cv-preview .a4-page {
            transition: all 0.5s ease !important;
        }

        .cv-restructuring .a4-page {
            transform: scale(0.9) rotate(1deg);
            filter: blur(2px);
            opacity: 0.8;
        }

        .cv-restructuring-complete .a4-page {
            transform: scale(1.05) rotate(0deg);
            filter: blur(0px) brightness(1.1);
            opacity: 1;
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.3) !important;
        }

        /* Effet de scintillement sur l'aperçu */
        @keyframes sparkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; transform: scale(1.02); }
        }

        .cv-sparkling {
            animation: sparkle 0.5s ease-in-out 3;
        }

        /* Effet de reconstruction progressive */
        .cv-module {
            transition: all 0.3s ease;
        }

        .cv-rebuilding .cv-module {
            animation: moduleReappear 0.8s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        .cv-rebuilding .cv-module:nth-child(1) { animation-delay: 0.1s; }
        .cv-rebuilding .cv-module:nth-child(2) { animation-delay: 0.2s; }
        .cv-rebuilding .cv-module:nth-child(3) { animation-delay: 0.3s; }
        .cv-rebuilding .cv-module:nth-child(4) { animation-delay: 0.4s; }
        .cv-rebuilding .cv-module:nth-child(5) { animation-delay: 0.5s; }

        @keyframes moduleReappear {
            0% {
                opacity: 0;
                transform: translateY(20px) scale(0.8);
            }
            50% {
                opacity: 0.7;
                transform: translateY(-5px) scale(1.05);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Effet de brillance qui traverse l'écran */
        .shine-effect {
            position: relative;
            overflow: hidden;
        }

        .shine-effect::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shine 1.5s ease-in-out;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Styles pour les barres redimensionnables */
        .resizable-panel {
            position: relative;
            transition: width 0.3s ease, height 0.3s ease;
        }

        .resize-handle {
            position: absolute;
            background: transparent;
            transition: all 0.2s ease;
            z-index: 100;
        }

        .resize-handle:hover,
        .resize-handle.dragging {
            background: rgba(59, 130, 246, 0.3);
        }

        .resize-handle-right {
            top: 0;
            right: -3px;
            width: 6px;
            height: 100%;
            cursor: ew-resize;
        }

        .resize-handle-bottom {
            left: 0;
            bottom: -3px;
            width: 100%;
            height: 6px;
            cursor: ns-resize;
        }

        .resize-handle-corner {
            bottom: -3px;
            right: -3px;
            width: 10px;
            height: 10px;
            cursor: nw-resize;
            background: rgba(59, 130, 246, 0.5);
            border-radius: 2px;
        }

        /* Styles pour le contrôleur de zoom */
        .zoom-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            padding: 15px;
            z-index: 1000;
            border: 1px solid #e5e7eb;
            min-width: 250px;
        }

        .zoom-slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 8px;
        }

        .zoom-slider {
            flex: 1;
            -webkit-appearance: none;
            appearance: none;
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            outline: none;
        }

        .zoom-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #3b82f6;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .zoom-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #3b82f6;
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .zoom-btn {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #374151;
            font-weight: bold;
        }

        .zoom-btn:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
        }

        .zoom-value {
            min-width: 45px;
            text-align: center;
            font-weight: 600;
            color: #374151;
            font-size: 14px;
        }

        /* Styles pour les boutons de toggle des panneaux */
        .panel-toggle {
            position: fixed;
            z-index: 999;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #374151;
            font-size: 14px;
        }

        .panel-toggle:hover {
            background: #f3f4f6;
            border-color: #3b82f6;
            color: #3b82f6;
        }

        .panel-toggle-left {
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
        }

        .panel-toggle-top {
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
        }

        /* Styles pour l'aperçu avec zoom */
        .cv-preview-container {
            transform-origin: top left;
            transition: transform 0.3s ease;
        }

        /* Styles pour les panneaux masqués */
        .panel-hidden {
            transform: translateX(-100%);
            opacity: 0;
            pointer-events: none;
        }

        .top-toolbar.panel-hidden {
            transform: translateY(-100%);
        }

        /* Animation pour les transitions */
        .transition-panel {
            transition: all 0.3s ease;
        }

        .ai-thinking-container {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #cbd5e1 100%);
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
            max-width: 500px;
            width: 90%;
            position: relative;
            overflow: hidden;
            border: 1px solid #e2e8f0;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1), 0 4px 10px rgba(0, 0, 0, 0.05);
        }

        .ai-brain {
            width: 100%;
            height: 120px;
            margin: 0 auto 1rem;
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            background: linear-gradient(45deg, rgba(248, 250, 252, 0.9), rgba(241, 245, 249, 0.8));
            border: 1px solid rgba(226, 232, 240, 0.6);
        }

        .ai-brain::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, rgba(59, 130, 246, 0.05), transparent);
        }

        .ai-neurons {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }

        .neuron {
            position: absolute;
            font-family: 'Inter', 'Segoe UI', sans-serif;
            font-size: 11px;
            color: #9ca3af;
            text-shadow: none;
            animation: matrixFall 3s linear infinite;
            font-weight: 400;
        }

        .neuron:nth-child(1) { left: 10%; animation-delay: 0s; }
        .neuron:nth-child(2) { left: 25%; animation-delay: 0.5s; }
        .neuron:nth-child(3) { left: 40%; animation-delay: 1s; }
        .neuron:nth-child(4) { left: 55%; animation-delay: 1.5s; }
        .neuron:nth-child(5) { left: 70%; animation-delay: 2s; }
        .neuron:nth-child(6) { left: 85%; animation-delay: 2.5s; }

        .ai-typing {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #6b7280;
            border-radius: 50%;
            animation: typingDots 1.4s ease-in-out infinite;
        }

        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        .ai-progress-bar {
            width: 100%;
            height: 4px;
            background: #f1f5f9;
            border-radius: 2px;
            margin: 1rem 0;
            overflow: hidden;
        }

        .ai-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #1d4ed8, #2563eb);
            border-radius: 2px;
            animation: aiProgress 3s ease-in-out infinite;
        }

        .cv-field-highlight {
            animation: fieldGlow 2s ease-in-out;
            position: relative;
        }

        .cv-field-highlight::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6, #06b6d4);
            border-radius: 6px;
            z-index: -1;
            animation: fieldBorder 2s ease-in-out;
        }

        @keyframes aiPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes aiFloat {
            0%, 100% { transform: translate(-50%, -50%) rotate(0deg); }
            25% { transform: translate(-50%, -50%) rotate(-10deg); }
            75% { transform: translate(-50%, -50%) rotate(10deg); }
        }

        @keyframes neuronPulse {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.5); }
        }

        @keyframes typingDots {
            0%, 20%, 80%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.5); opacity: 1; }
        }

        @keyframes aiProgress {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }

        @keyframes fieldGlow {
            0% { box-shadow: 0 0 0 rgba(59, 130, 246, 0); }
            50% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.6); }
            100% { box-shadow: 0 0 0 rgba(59, 130, 246, 0); }
        }

        @keyframes fieldBorder {
            0% { opacity: 0; }
            50% { opacity: 1; }
            100% { opacity: 0; }
        }

        .ai-step-indicator {
            display: flex;
            justify-content: space-between;
            margin: 1rem 0;
            padding: 0 1rem;
        }

        .ai-step {
            flex: 1;
            text-align: center;
            padding: 0.5rem;
            border-radius: 8px;
            background: #f3f4f6;
            margin: 0 0.25rem;
            transition: all 0.3s ease;
        }

        .ai-step.active {
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            color: white;
            transform: scale(1.05);
        }

        .ai-step.completed {
            background: #10b981;
            color: white;
        }
        .skill-item .delete-skill-btn { display: none; position: absolute; top: 50%; right: 5px; transform: translateY(-50%); cursor: pointer; font-size: 14px; line-height: 1; color: #9ca3af; padding: 2px; }
        .skill-item:hover .delete-skill-btn { display: inline-block; }
        .skill-item .delete-skill-btn:hover { color: #ef4444; }
        .style-toggle-btn.active, .skill-style-btn.active, .section-title-style-btn.active, .layout-btn.active, .banner-align-btn.active, .logo-size-btn.active, .theme-btn.active, #banner-invert-btn.active, .gauge-style-btn.active, #toggle-overflow-btn.active { background-color: #3b82f6; color: white; }
        .skill-level { display: flex; align-items: center; margin-bottom: 6px; gap: 8px; }
        .skill-level-label { width: 120px; flex-shrink: 0; font-size: var(--font-size-p); }
        
        /* Gauge Styles */
        .gauge-container { flex-grow: 1; }
        .gauge-bar-bg { background-color: #e5e7eb; border-radius: 4px; height: 8px; overflow: hidden;}
        .gauge-bar-fill { background-color: var(--primary-color); height: 100%; border-radius: 4px; transition: width 0.3s ease; }
        .gauge-dots, .gauge-stars, .gauge-squares { display: flex; gap: 4px; font-size: 1.2em; color: #d1d5db; }
        .gauge-dots .filled, .gauge-stars .filled, .gauge-squares .filled { color: var(--primary-color); }
        .gauge-number { font-weight: bold; color: var(--secondary-color); }

        .editable-wrapper { position: relative; }
        .editable-wrapper .delete-line-btn { display: none; position: absolute; top: 50%; right: 2px; transform: translateY(-50%); cursor: pointer; color: #ef4444; background-color: white; border-radius: 50%; width: 18px; height: 18px; text-align: center; line-height: 18px; font-size: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); z-index: 5; }
        .editable-wrapper:hover .delete-line-btn { display: flex; align-items: center; justify-content: center; }
        .history-btn:disabled { opacity: 0.4; cursor: not-allowed; }
        .insert-line-wrapper { position: relative; height: 0.5rem; opacity: 0; transition: opacity 0.2s; margin: 0; display: flex; justify-content: center; align-items: center; }
        .dynamic-item-container:hover .insert-line-wrapper { opacity: 1; }
        .add-line-preview-btn { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: #eef2ff; color: #4f46e5; border: 1px dashed #a5b4fc; width: 24px; height: 24px; border-radius: 50%; cursor: pointer; z-index: 5; display: flex; align-items: center; justify-content: center; font-size: 12px; transition: all 0.2s; }
        .add-line-preview-btn:hover { background: #c7d2fe; border-style: solid; transform: translate(-50%, -50%) scale(1.1); }
        
        .add-desc-line-btn { display: none; font-size: 0.8rem; color: #4f46e5; cursor: pointer; margin-top: 0.25rem; padding: 2px 4px; border-radius: 4px; background: transparent; border: none; }
        .add-desc-line-btn:hover { background-color: #eef2ff; }
        .dynamic-preview-item:hover .add-desc-line-btn { display: inline-block; }

        .dynamic-preview-item { position: relative; border: 1px solid transparent; border-radius: 0.375rem; padding: 0.5rem; margin-bottom: var(--item-spacing); transition: border-color 0.2s, background-color 0.2s, opacity 0.3s; }
        .dynamic-preview-item:hover { background-color: #fafafa; border-color: #e5e7eb; }

        .delete-block-btn { display: none; position: absolute; top: 4px; right: 4px; width: 24px; height: 24px; background-color: #fee2e2; color: #b91c1c; border: none; border-radius: 50%; cursor: pointer; align-items: center; justify-content: center; z-index: 6; }
        .dynamic-preview-item:hover .delete-block-btn { display: flex; }
        .delete-block-btn:hover { background-color: #fecaca; color: #991b1b; }
        .new-badge { background-color: #ef4444; color: white; font-size: 0.6rem; font-weight: bold; padding: 2px 5px; border-radius: 4px; margin-left: 6px; vertical-align: middle; }
        
        /* Modal Styles */
        .modal-overlay { position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; z-index: 5000; opacity: 0; transition: opacity 0.2s; pointer-events: none; }
        .modal-overlay.active { opacity: 1; pointer-events: auto; }
        .modal-content { background: white; padding: 2rem; border-radius: 0.5rem; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 90%; max-width: 500px; transform: scale(0.95); transition: transform 0.2s; }
        .modal-overlay.active .modal-content { transform: scale(1); }
        
        /* Icon Picker Modal */
        #icon-picker-modal .modal-content { max-width: 700px; }
        #icon-picker-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(50px, 1fr)); gap: 0.5rem; max-height: 60vh; overflow-y: auto; }
        #icon-picker-grid i { font-size: 1.5rem; padding: 0.75rem; border-radius: 0.25rem; cursor: pointer; text-align: center; transition: background-color 0.2s, color 0.2s; }
        #icon-picker-grid i:hover { background-color: #eef2ff; color: #4f46e5; }
        
        /* In-Preview AI Buttons */
        .section-ai-actions { margin-left: auto; display: flex; gap: 0.5rem; opacity: 0; transition: opacity 0.2s; }
        .cv-module:hover .section-ai-actions { opacity: 1; }
        .ai-action-btn { background: #e0e7ff; color: #4338ca; border: none; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 0.8rem; }
        .ai-action-btn:hover { background: #c7d2fe; }

        /* Styles for hiding sections */
        .cv-module.section-hidden > *:not(h2) {
            display: none;
        }
        .cv-module.section-hidden > h2 {
            opacity: 0.5;
        }

        /* For column resizing */
        .column-resizer {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 10px; /* Wider grab area */
            cursor: col-resize;
            transform: translateX(-50%);
            z-index: 20; /* High z-index */
        }
        .column-resizer::after {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            left: 4px; /* Centered 2px line in a 10px div */
            width: 2px;
            background-color: #d1d5db;
            transition: background-color 0.2s ease;
        }
        .column-resizer:hover::after,
        body.is-resizing .column-resizer::after {
            background-color: #3b82f6;
        }
        body.is-resizing {
            cursor: col-resize;
            user-select: none;
        }

        /* Presentation Mode & Print Styles */
        body.presentation-mode .cv-column {
            border-color: transparent;
        }
        body.presentation-mode .column-resizer,
        body.presentation-mode .drag-handle,
        body.presentation-mode .remove-page-btn,
        body.presentation-mode #add-page-btn-wrapper,
        body.presentation-mode .section-ai-actions,
        body.presentation-mode .delete-block-btn,
        body.presentation-mode .delete-line-btn,
        body.presentation-mode .insert-line-wrapper {
            display: none !important;
        }
        /* NEW: Completely hide the module in presentation mode if hidden */
        body.presentation-mode .cv-module.section-hidden {
            display: none !important;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            .column-resizer,
            .drag-handle {
                display: none !important;
            }
            .cv-column {
                border-color: transparent !important;
            }
            .no-print {
                display: none !important;
            }
            .cv-module.section-hidden {
                display: none !important;
            }
            .a4-page {
                box-shadow: none !important;
                margin: 0;
                overflow: visible;
                height: auto;
                break-inside: avoid-page;
            }
            #cv-preview-wrapper {
                gap: 0;
            }
        }

        /* Styles pour la barre d'outils supérieure */
        .top-toolbar {
            background: #ffffff;
            padding: 12px 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            z-index: 1000;
            position: relative;
        }
        
        .top-toolbar .toolbar-section {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .toolbar-btn {
            background: #f8fafc;
            color: #374151;
            border: 1px solid #d1d5db;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }
        
        .toolbar-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.12);
        }
        
        /* Couleurs spécifiques pour chaque bouton */
        #toolbar-pdf-btn {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            color: white;
            border-color: #dc2626;
        }
        
        #toolbar-pdf-btn:hover {
            background: linear-gradient(135deg, #b91c1c, #dc2626);
        }
        
        #toolbar-share-btn {
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
            border-color: #059669;
        }
        
        #toolbar-share-btn:hover {
            background: linear-gradient(135deg, #047857, #059669);
        }
        
        #toolbar-anonymize-btn {
            background: linear-gradient(135deg, #7c3aed, #8b5cf6);
            color: white;
            border-color: #7c3aed;
        }
        
        #toolbar-anonymize-btn:hover {
            background: linear-gradient(135deg, #6d28d9, #7c3aed);
        }
        
        #toolbar-new-cv-btn {
            background: linear-gradient(135deg, #ea580c, #f97316);
            color: white;
            border-color: #ea580c;
        }
        
        #toolbar-new-cv-btn:hover {
            background: linear-gradient(135deg, #c2410c, #ea580c);
        }
        
        #toolbar-overflow-btn {
            background: linear-gradient(135deg, #eab308, #facc15);
            color: #374151;
            border-color: #eab308;
        }
        
        #toolbar-overflow-btn:hover {
            background: linear-gradient(135deg, #ca8a04, #eab308);
        }
        
        #toolbar-presentation-btn {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            color: white;
            border-color: #3b82f6;
        }
        
        #toolbar-presentation-btn:hover {
            background: linear-gradient(135deg, #2563eb, #3b82f6);
        }
        
        #toolbar-save-btn {
            background: linear-gradient(135deg, #16a34a, #22c55e);
            color: white;
            border-color: #16a34a;
        }
        
        #toolbar-save-btn:hover {
            background: linear-gradient(135deg, #15803d, #16a34a);
        }
        
        #toolbar-accessibility-btn {
            background: linear-gradient(135deg, #7c3aed, #a855f7);
            color: white;
            border-color: #7c3aed;
            font-weight: 600;
        }
        
        #toolbar-accessibility-btn:hover {
            background: linear-gradient(135deg, #6d28d9, #7c3aed);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
        }
        
        #toolbar-template-btn {
            background: linear-gradient(135deg, #1d4ed8, #3b82f6);
            color: white;
            border-color: #1d4ed8;
            font-weight: 600;
        }
        
        #toolbar-template-btn:hover {
            background: linear-gradient(135deg, #1e40af, #1d4ed8);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(29, 78, 216, 0.3);
        }
        
        #toolbar-load-btn {
            background: linear-gradient(135deg, #0891b2, #06b6d4);
            color: white;
            border-color: #0891b2;
        }
        
        #toolbar-load-btn:hover {
            background: linear-gradient(135deg, #0e7490, #0891b2);
        }
        
        #save-api-key-btn {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border-color: #6366f1;
        }
        
        #save-api-key-btn:hover {
            background: linear-gradient(135deg, #4f46e5, #6366f1);
        }
        
        /* Styles pour le sélecteur d'API */
        .api-selector-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-width: 280px;
        }
        
        .api-provider-selector {
            display: flex;
            background: rgba(15, 23, 42, 0.8);
            border-radius: 8px;
            padding: 2px;
            border: 1px solid rgba(99, 102, 241, 0.3);
        }
        
        .api-provider-btn {
            flex: 1;
            padding: 6px 12px;
            background: transparent;
            color: #cbd5e1;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
            font-weight: 500;
        }
        
        .api-provider-btn.active {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            box-shadow: 0 2px 4px rgba(99, 102, 241, 0.3);
        }
        
        .api-provider-btn:hover:not(.active) {
            background: rgba(99, 102, 241, 0.1);
            color: #e2e8f0;
        }
        
        .api-key-group {
            display: flex;
            gap: 6px;
            align-items: center;
        }
        
        .api-key-input {
            flex: 1;
            min-width: 200px;
        }
        
        .api-switch-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: 1px solid #10b981;
            padding: 6px 10px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .api-switch-btn:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-1px);
        }
        
        .api-status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #ef4444;
            margin-left: 4px;
            transition: all 0.3s ease;
        }
        
        .api-status-indicator.connected {
            background: #10b981;
            box-shadow: 0 0 6px rgba(16, 185, 129, 0.4);
        }
        
        .toolbar-btn.active {
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
            transform: translateY(-1px);
        }
        
        .toolbar-divider {
            width: 1px;
            height: 30px;
            background: #d1d5db;
        }
        
        .gemini-key-input {
            background: #f9fafb;
            border: 1px solid #d1d5db;
            color: #374151;
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 12px;
            width: 200px;
        }
        
        .gemini-key-input::placeholder {
            color: #9ca3af;
        }
        
        .gemini-key-input.valid {
            border-color: rgba(34, 197, 94, 0.6);
            box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.3);
        }
        
        .gemini-key-input.invalid {
            border-color: rgba(239, 68, 68, 0.6);
            box-shadow: 0 0 0 1px rgba(239, 68, 68, 0.3);
        }
        
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 1px rgba(239, 68, 68, 0.3); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.6); }
            100% { transform: scale(1); box-shadow: 0 0 0 1px rgba(239, 68, 68, 0.3); }
        }
        
        /* Styles pour les tooltips */
        .tooltip {
            position: relative;
            cursor: pointer;
        }
        
        .tooltip-content {
            position: absolute;
            background: #1f2937;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            line-height: 1.4;
            white-space: nowrap;
            max-width: 300px;
            white-space: normal;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
            z-index: 10000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            pointer-events: none;
        }
        
        .tooltip-content::after {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border: 6px solid transparent;
        }
        
        .tooltip:hover .tooltip-content {
            opacity: 1;
            visibility: visible;
        }
        
        /* Positionnement intelligent des tooltips */
        .tooltip-content.top {
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
        }
        
        .tooltip-content.top::after {
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border-top-color: #1f2937;
        }
        
        .tooltip-content.bottom {
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-top: 8px;
        }
        
        .tooltip-content.bottom::after {
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border-bottom-color: #1f2937;
        }
        
        .tooltip-content.left {
            right: 100%;
            top: 50%;
            transform: translateY(-50%);
            margin-right: 8px;
        }
        
        .tooltip-content.left::after {
            left: 100%;
            top: 50%;
            transform: translateY(-50%);
            border-left-color: #1f2937;
        }
        
        .tooltip-content.right {
            left: 100%;
            top: 50%;
            transform: translateY(-50%);
            margin-left: 8px;
        }
        
        .tooltip-content.right::after {
            right: 100%;
            top: 50%;
            transform: translateY(-50%);
            border-right-color: #1f2937;
        }

        /* --- ANIMATIONS MATRIX RAIN SPECTACULAIRES --- */
        
        @keyframes matrixFall {
            from {
                transform: translateY(-100%);
                opacity: 1;
            }
            to {
                transform: translateY(100vh);
                opacity: 0;
            }
        }
        
        @keyframes matrixGlow {
            0%, 100% {
                text-shadow: 0 0 5px currentColor;
                opacity: 0.8;
            }
            50% {
                text-shadow: 0 0 15px currentColor, 0 0 25px currentColor;
                opacity: 1;
            }
        }
        
        @keyframes matrixPulse {
            0%, 100% {
                box-shadow: 0 0 20px rgba(0, 255, 65, 0.3);
                border-color: rgba(0, 255, 65, 0.5);
            }
            50% {
                box-shadow: 0 0 40px rgba(0, 255, 65, 0.8);
                border-color: rgba(0, 255, 65, 1);
            }
        }
        
        @keyframes matrixReconstruct {
            0% {
                opacity: 0.3;
                transform: scale(0.95);
                filter: blur(2px);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.02);
                filter: blur(1px);
            }
            100% {
                opacity: 1;
                transform: scale(1);
                filter: blur(0);
            }
        }
        
        @keyframes scanHorizontal {
            0% {
                transform: translateX(-100%);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateX(100%);
                opacity: 0;
            }
        }
        
        @keyframes fadeInOut {
            0% {
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                opacity: 0;
            }
        }
        
        @keyframes typeIn {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes compilationFlash {
            0% {
                opacity: 0;
                background: linear-gradient(45deg, rgba(0, 255, 65, 0.1), rgba(0, 255, 65, 0.3));
            }
            25% {
                opacity: 0.8;
                background: linear-gradient(45deg, rgba(0, 255, 65, 0.3), rgba(0, 255, 65, 0.6));
            }
            75% {
                opacity: 0.6;
                background: linear-gradient(45deg, rgba(0, 255, 65, 0.2), rgba(0, 255, 65, 0.4));
            }
            100% {
                opacity: 0;
                background: linear-gradient(45deg, transparent, transparent);
            }
        }
        
        @keyframes matrixReveal {
            0% {
                filter: brightness(1.5) contrast(1.2);
                transform: scale(1.02);
            }
            100% {
                filter: brightness(1) contrast(1);
                transform: scale(1);
            }
        }
        
        /* Styles pour les éléments Matrix */
        .matrix-column {
            will-change: transform;
        }
        
        .matrix-code-overlay {
            backdrop-filter: blur(2px);
        }
        
        .matrix-rain-container {
            background: radial-gradient(ellipse at center, rgba(0, 255, 65, 0.05) 0%, transparent 70%);
        }
        
        /* Effet de typing professionnel sur le texte */
        .matrix-typing {
            color: #374151;
            font-family: 'Inter', 'Segoe UI', sans-serif;
            text-shadow: none;
            font-weight: 500;
        }

        /* === ANIMATIONS PROFESSIONNELLES ULTRA-RAPIDES === */
        @keyframes professionalFall {
            0% { 
                transform: translateY(-100vh);
                opacity: 0;
            }
            10% {
                opacity: 0.3;
            }
            90% {
                opacity: 0.3;
            }
            100% { 
                transform: translateY(100vh);
                opacity: 0;
            }
        }

        @keyframes professionalTransform {
            0% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.7;
                transform: scale(1.01);
                filter: blur(0.5px);
            }
            100% {
                opacity: 1;
                transform: scale(1);
                filter: blur(0);
            }
        }

        @keyframes professionalScan {
            0% {
                transform: translateX(-100%);
                opacity: 0;
            }
            50% {
                opacity: 0.8;
            }
            100% {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        @keyframes professionalFlash {
            0% {
                opacity: 0;
            }
            50% {
                opacity: 0.3;
            }
            100% {
                opacity: 0;
            }
        }

        @keyframes professionalReveal {
            0% {
                opacity: 0.95;
                transform: scale(0.998);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* === STYLES D'ACCESSIBILITÉ === */
        
        /* Classes d'accessibilité dynamiques */
        .high-contrast {
            filter: contrast(150%) brightness(1.1);
        }
        
        .dark-mode {
            filter: invert(1) hue-rotate(180deg);
        }
        
        .enhanced-focus *:focus {
            outline: 3px solid #7c3aed !important;
            outline-offset: 2px !important;
        }
        
        .reduced-animations * {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }
        
        .screen-reader-optimized .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* Styles pour la popup d'accessibilité */
        .contrast-btn {
            transition: all 0.2s ease;
        }
        
        .contrast-btn.active {
            background-color: #7c3aed;
            color: white;
            border-color: #7c3aed;
        }
        
        .contrast-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        /* Styles pour les sliders */
        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #7c3aed;
            cursor: pointer;
            border: 2px solid #ffffff;
            box-shadow: 0 0 0 1px #d1d5db;
        }
        
        input[type="range"]::-moz-range-thumb {
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #7c3aed;
            cursor: pointer;
            border: 2px solid #ffffff;
            box-shadow: 0 0 0 1px #d1d5db;
        }
        
        input[type="range"]:focus {
            outline: none;
        }
        
        input[type="range"]:focus::-webkit-slider-thumb {
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.2);
        }
        
        /* Styles pour les checkboxes accessibles */
        input[type="checkbox"]:focus {
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.2);
        }
        
        /* Styles pour les éléments kbd */
        kbd {
            background-color: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-family: ui-monospace, SFMono-Regular, "SF Mono", Consolas, "Liberation Mono", Menlo, monospace;
            font-size: 0.75rem;
            font-weight: 600;
            padding: 2px 6px;
        }
        
        /* Animation pour la modal d'accessibilité */
        #accessibility-modal {
            backdrop-filter: blur(4px);
            transition: opacity 0.3s ease;
        }
        
        #accessibility-modal.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        #accessibility-modal:not(.hidden) {
            opacity: 1;
            pointer-events: auto;
        }

    </style>
</head>
<body class="bg-gray-200 font-sans">

    <!-- BARRE D'OUTILS SUPÉRIEURE -->
    <div class="top-toolbar no-print resizable-panel transition-panel">
        <!-- Handle de redimensionnement pour la barre du haut -->
        <div class="resize-handle resize-handle-bottom" data-panel="top-toolbar"></div>
        
        <div class="toolbar-section">
            <div class="tooltip">
                <button id="toolbar-accessibility-btn" class="toolbar-btn" aria-label="Ouvrir les paramètres d'accessibilité">
                    <i class="fas fa-universal-access"></i>
                    ACCESSIBILITÉ
                </button>
                <div class="tooltip-content bottom">
                    <strong>Paramètres d'accessibilité</strong><br>
                    Personnalisez l'affichage selon vos besoins :<br>
                    contraste, taille de texte, navigation clavier, etc.
                </div>
            </div>
            
            <div class="tooltip">
                <button id="toolbar-pdf-btn" class="toolbar-btn">
                    <i class="fas fa-file-pdf"></i>
                    PDF
                </button>
                <div class="tooltip-content bottom">
                    <strong>Télécharger en PDF</strong><br>
                    Génère et télécharge votre CV au format PDF de haute qualité,<br>
                    optimisé pour l'impression et l'envoi par email aux recruteurs.
                </div>
            </div>
            
            <div class="tooltip">
                <button id="toolbar-share-btn" class="toolbar-btn">
                    <i class="fas fa-share-alt"></i>
                    PARTAGER
                </button>
                <div class="tooltip-content bottom">
                    <strong>Partager le CV</strong><br>
                    Créez un lien de partage unique pour envoyer votre CV<br>
                    en version web consultable à vos contacts ou recruteurs.
                </div>
            </div>
            
            <div class="tooltip">
                <button id="toolbar-anonymize-btn" class="toolbar-btn">
                    <i class="fas fa-user-secret"></i>
                    ANONYMISER
                </button>
                <div class="tooltip-content bottom">
                    <strong>Anonymiser le CV</strong><br>
                    Masque temporairement vos informations personnelles<br>
                    (nom, email, téléphone) pour créer une version anonyme.
                </div>
            </div>
            
            <div class="tooltip">
                <button id="toolbar-new-cv-btn" class="toolbar-btn">
                    <i class="fas fa-file-plus"></i>
                    NOUVEAU CV
                </button>
                <div class="tooltip-content bottom">
                    <strong>Créer un nouveau CV</strong><br>
                    Efface complètement le CV actuel et repart sur<br>
                    une base vierge pour créer un nouveau document.
                </div>
            </div>
        </div>
        
        <div class="toolbar-divider"></div>
        
        <div class="toolbar-section">
            <div class="tooltip">
                <button id="toolbar-overflow-btn" class="toolbar-btn">
                    <i class="fas fa-ruler-combined"></i>
                    DÉTECTION DÉPASSEMENT
                </button>
                <div class="tooltip-content bottom">
                    <strong>Mode Détection de Dépassement</strong><br>
                    Active le surlignage visuel des pages qui débordent<br>
                    pour vous aider à optimiser la mise en page.
                </div>
            </div>
            
            <div class="tooltip">
                <button id="toolbar-presentation-btn" class="toolbar-btn">
                    <i class="fas fa-presentation-screen"></i>
                    MODE PRÉSENTATION
                </button>
                <div class="tooltip-content bottom">
                    <strong>Mode Présentation</strong><br>
                    Masque tous les éléments d'édition pour une vue<br>
                    claire et propre, idéale pour présenter votre CV.
                </div>
            </div>
        </div>
        
        <div class="toolbar-divider"></div>
        
        <div class="toolbar-section">
            <div class="tooltip">
                <button id="toolbar-save-btn" class="toolbar-btn">
                    <i class="fas fa-save"></i>
                    SAUVEGARDER
                </button>
                <div class="tooltip-content bottom">
                    <strong>Sauvegarder localement</strong><br>
                    Enregistre votre CV dans le stockage local du navigateur<br>
                    pour ne pas perdre vos modifications.
                </div>
            </div>
            
            <div class="tooltip">
                <button id="toolbar-load-btn" class="toolbar-btn">
                    <i class="fas fa-folder-open"></i>
                    CHARGER
                </button>
                <div class="tooltip-content bottom">
                    <strong>Charger la sauvegarde</strong><br>
                    Charge la dernière version sauvegardée de votre CV<br>
                    depuis le stockage local du navigateur.
                </div>
            </div>
            
            <div class="tooltip">
                <button id="toolbar-template-btn" class="toolbar-btn">
                    <i class="fas fa-layer-group"></i>
                    TEMPLATES
                </button>
                <div class="tooltip-content bottom">
                    <strong>Gestion des Templates</strong><br>
                    Sauvegardez et réutilisez vos mises en page<br>
                    favorites pour créer de nouveaux CV rapidement.
                </div>
            </div>
            
            <div class="tooltip">
                <div class="api-selector-container">
                    <!-- Sélecteur de fournisseur d'API -->
                    <div class="api-provider-selector">
                        <button id="select-gemini-btn" class="api-provider-btn active">
                            <i class="fas fa-brain"></i> Gemini
                        </button>
                        <button id="select-chatgpt-btn" class="api-provider-btn">
                            <i class="fas fa-robot"></i> ChatGPT
                        </button>
                    </div>
                    
                    <!-- Champ pour Gemini API -->
                    <div id="gemini-api-group" class="api-key-group">
                        <input type="text" id="gemini-api-key" class="gemini-key-input api-key-input" placeholder="Clé API Gemini (AIza...)">
                        <button id="save-gemini-key-btn" class="toolbar-btn" style="padding: 6px 10px; font-size: 12px;">
                            <i class="fas fa-save"></i>
                        </button>
                        <div id="gemini-status" class="api-status-indicator"></div>
                    </div>
                    
                    <!-- Champ pour ChatGPT API -->
                    <div id="chatgpt-api-group" class="api-key-group" style="display: none;">
                        <input type="text" id="chatgpt-api-key" class="gemini-key-input api-key-input" placeholder="Clé API OpenAI (sk-...)">
                        <button id="save-chatgpt-key-btn" class="toolbar-btn" style="padding: 6px 10px; font-size: 12px;">
                            <i class="fas fa-save"></i>
                        </button>
                        <div id="chatgpt-status" class="api-status-indicator"></div>
                    </div>
                    
                    <!-- Bouton de basculement rapide -->
                    <button id="switch-api-btn" class="api-switch-btn">
                        <i class="fas fa-exchange-alt"></i>
                        <span id="switch-api-text">Utiliser ChatGPT</span>
                    </button>
                </div>
                <div class="tooltip-content bottom">
                    <strong>Configuration des API IA</strong><br>
                    <span id="current-api-info">
                        Gemini: Entrez votre clé API Google Gemini<br>
                        ChatGPT: Entrez votre clé API OpenAI<br>
                    </span>
                    Basculez entre les fournisseurs selon vos besoins.<br>
                    Les clés sont sauvegardées localement dans votre navigateur.
                </div>
            </div>
        </div>
    </div>

    <!-- OVERLAYS AND MODALS -->
    <div id="loader-overlay" class="hidden fixed inset-0 bg-white bg-opacity-75 flex-col items-center justify-center z-[9999]" style="pointer-events: none;">
        <div class="h-16 w-16 rounded-full border-4 border-gray-200 border-t-blue-600 animate-spin"></div>
        <p id="loader-text" class="mt-4 text-gray-600 font-medium">Chargement...</p>
    </div>

    <!-- CONTENEUR DE NOTIFICATIONS MODERNES -->
    <div id="notification-container"></div>

    <!-- FENÊTRE POPUP D'ACCESSIBILITÉ -->
    <div id="accessibility-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10000] hidden" role="dialog" aria-labelledby="accessibility-title" aria-modal="true">
        <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <header class="flex items-center justify-between p-6 border-b border-gray-200">
                <h2 id="accessibility-title" class="text-2xl font-bold text-gray-900 flex items-center gap-3">
                    <i class="fas fa-universal-access text-purple-600"></i>
                    Paramètres d'accessibilité
                </h2>
                <button id="close-accessibility-modal" class="text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 rounded-md p-2" aria-label="Fermer la fenêtre d'accessibilité">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </header>
            
            <div class="p-6 grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Section Affichage -->
                <section class="space-y-6">
                    <h3 class="text-xl font-semibold text-gray-800 border-b border-gray-200 pb-2">
                        <i class="fas fa-eye text-blue-600 mr-2"></i>
                        Affichage et visibilité
                    </h3>
                    
                    <!-- Contraste -->
                    <div class="space-y-3">
                        <label class="block text-sm font-medium text-gray-700">Contraste élevé</label>
                        <div class="flex items-center space-x-4">
                            <button id="contrast-normal" class="contrast-btn active px-4 py-2 rounded-md border-2 border-gray-300 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500" aria-pressed="true">
                                Normal
                            </button>
                            <button id="contrast-high" class="contrast-btn px-4 py-2 rounded-md border-2 border-gray-900 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500" aria-pressed="false">
                                Contraste élevé
                            </button>
                            <button id="contrast-dark" class="contrast-btn px-4 py-2 rounded-md border-2 border-white bg-gray-900 text-white focus:outline-none focus:ring-2 focus:ring-purple-500" aria-pressed="false">
                                Mode sombre
                            </button>
                        </div>
                    </div>
                    
                    <!-- Taille de texte -->
                    <div class="space-y-3">
                        <label for="font-size-slider" class="block text-sm font-medium text-gray-700">
                            Taille du texte: <span id="font-size-value">100%</span>
                        </label>
                        <input type="range" id="font-size-slider" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer focus:outline-none focus:ring-2 focus:ring-purple-500" min="80" max="150" value="100" step="10" aria-describedby="font-size-help">
                        <p id="font-size-help" class="text-xs text-gray-500">Ajustez la taille du texte selon vos besoins de lecture</p>
                    </div>
                    
                    <!-- Espacement des lignes -->
                    <div class="space-y-3">
                        <label for="line-height-slider" class="block text-sm font-medium text-gray-700">
                            Espacement des lignes: <span id="line-height-value">Normal</span>
                        </label>
                        <input type="range" id="line-height-slider" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer focus:outline-none focus:ring-2 focus:ring-purple-500" min="1" max="2" value="1.5" step="0.1" aria-describedby="line-height-help">
                        <p id="line-height-help" class="text-xs text-gray-500">Augmentez l'espacement pour faciliter la lecture</p>
                    </div>
                    
                    <!-- Focus visible -->
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <input type="checkbox" id="enhanced-focus" class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
                            <label for="enhanced-focus" class="ml-2 block text-sm text-gray-700">
                                Améliorer la visibilité du focus clavier
                            </label>
                        </div>
                        <p class="text-xs text-gray-500">Rend plus visible l'élément actuellement sélectionné lors de la navigation au clavier</p>
                    </div>
                </section>
                
                <!-- Section Navigation -->
                <section class="space-y-6">
                    <h3 class="text-xl font-semibold text-gray-800 border-b border-gray-200 pb-2">
                        <i class="fas fa-keyboard text-green-600 mr-2"></i>
                        Navigation et interactions
                    </h3>
                    
                    <!-- Navigation clavier -->
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <input type="checkbox" id="keyboard-shortcuts" class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded" checked>
                            <label for="keyboard-shortcuts" class="ml-2 block text-sm text-gray-700">
                                Activer les raccourcis clavier
                            </label>
                        </div>
                        <div class="text-xs text-gray-600 ml-6 space-y-1">
                            <p><kbd class="px-2 py-1 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded">Ctrl+S</kbd> Sauvegarder</p>
                            <p><kbd class="px-2 py-1 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded">Ctrl+P</kbd> Exporter PDF</p>
                            <p><kbd class="px-2 py-1 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded">Échap</kbd> Fermer les modales</p>
                        </div>
                    </div>
                    
                    <!-- Animations réduites -->
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <input type="checkbox" id="reduce-animations" class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
                            <label for="reduce-animations" class="ml-2 block text-sm text-gray-700">
                                Réduire les animations
                            </label>
                        </div>
                        <p class="text-xs text-gray-500">Diminue ou désactive les effets visuels et animations pour réduire les distractions</p>
                    </div>
                    
                    <!-- Lecture d'écran -->
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <input type="checkbox" id="screen-reader-mode" class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
                            <label for="screen-reader-mode" class="ml-2 block text-sm text-gray-700">
                                Mode optimisé pour les lecteurs d'écran
                            </label>
                        </div>
                        <p class="text-xs text-gray-500">Améliore la compatibilité avec les technologies d'assistance comme NVDA, JAWS, VoiceOver</p>
                    </div>
                    
                    <!-- Descriptions étendues -->
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <input type="checkbox" id="extended-descriptions" class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
                            <label for="extended-descriptions" class="ml-2 block text-sm text-gray-700">
                                Descriptions étendues des éléments
                            </label>
                        </div>
                        <p class="text-xs text-gray-500">Ajoute des descriptions détaillées pour les éléments interactifs</p>
                    </div>
                </section>
            </div>
            
            <!-- Section Déclaration d'accessibilité -->
            <div class="p-6 bg-gray-50 border-t border-gray-200">
                <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                    <i class="fas fa-certificate text-green-600"></i>
                    Déclaration d'accessibilité
                </h3>
                <div class="prose prose-sm max-w-none text-gray-700">
                    <p class="mb-3">
                        <strong>Créateur de CV</strong> s'engage à rendre cette application accessible conformément aux bonnes pratiques et aux standards d'accessibilité web.
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-4">
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-2">Fonctionnalités accessibles :</h4>
                            <ul class="list-disc list-inside space-y-1 text-sm">
                                <li>Navigation complète au clavier</li>
                                <li>Compatibilité avec les lecteurs d'écran</li>
                                <li>Contrastes respectant les normes WCAG</li>
                                <li>Textes alternatifs pour les éléments visuels</li>
                                <li>Structure sémantique appropriée</li>
                                <li>Focus visible et ordonné</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-2">Technologies supportées :</h4>
                            <ul class="list-disc list-inside space-y-1 text-sm">
                                <li>NVDA (Windows)</li>
                                <li>JAWS (Windows)</li>
                                <li>VoiceOver (macOS/iOS)</li>
                                <li>TalkBack (Android)</li>
                                <li>Navigation clavier</li>
                                <li>Commandes vocales</li>
                            </ul>
                        </div>
                    </div>
                    <p class="text-sm text-gray-600">
                        Pour toute difficulté d'accessibilité ou suggestion d'amélioration, vous pouvez nous contacter.
                        Nous nous engageons à fournir une version accessible de tout contenu sur demande.
                    </p>
                </div>
            </div>
            
            <!-- Actions -->
            <div class="p-6 bg-white border-t border-gray-200 flex justify-between items-center">
                <button id="reset-accessibility" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2">
                    <i class="fas fa-undo mr-2"></i>
                    Réinitialiser
                </button>
                <div class="flex space-x-3">
                    <button id="save-accessibility" class="px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2">
                        <i class="fas fa-save mr-2"></i>
                        Sauvegarder les préférences
                    </button>
                    <button id="close-accessibility-modal-bottom" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2">
                        Fermer
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL DE GESTION DES TEMPLATES -->
    <div id="template-manager-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10000] hidden" role="dialog" aria-labelledby="template-title" aria-modal="true">
        <div class="bg-white rounded-lg shadow-xl max-w-5xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <header class="flex items-center justify-between p-6 border-b border-gray-200">
                <h2 id="template-title" class="text-2xl font-bold text-gray-900 flex items-center gap-3">
                    <i class="fas fa-layer-group text-blue-600"></i>
                    Gestion des Templates de Mise en Page
                </h2>
                <button id="close-template-modal" class="text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded-md p-2" aria-label="Fermer la fenêtre de gestion des templates">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </header>
            
            <div class="p-6">
                <!-- Actions principales -->
                <div class="mb-6 flex flex-wrap gap-3">
                    <button id="save-current-template" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors">
                        <i class="fas fa-save mr-2"></i>
                        Sauvegarder la mise en page actuelle
                    </button>
                    <button id="export-templates" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors">
                        <i class="fas fa-download mr-2"></i>
                        Exporter tous les templates
                    </button>
                    <button id="import-templates" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-colors">
                        <i class="fas fa-upload mr-2"></i>
                        Importer des templates
                    </button>
                    <input type="file" id="template-file-input" accept=".json" class="hidden">
                </div>
                
                <!-- Liste des templates sauvegardés -->
                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-gray-800 border-b border-gray-200 pb-2">
                        <i class="fas fa-list mr-2"></i>
                        Templates sauvegardés
                    </h3>
                    
                    <div id="templates-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Les templates seront ajoutés ici dynamiquement -->
                    </div>
                    
                    <div id="no-templates-message" class="text-center py-8 text-gray-500 hidden">
                        <i class="fas fa-inbox text-4xl mb-4 text-gray-300"></i>
                        <p class="text-lg">Aucun template sauvegardé</p>
                        <p class="text-sm">Sauvegardez votre première mise en page pour la réutiliser</p>
                    </div>
                </div>
            </div>
            
            <!-- Actions de fermeture -->
            <div class="p-6 bg-gray-50 border-t border-gray-200 flex justify-end">
                <button id="close-template-modal-bottom" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                    Fermer
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL DE SAUVEGARDE DE TEMPLATE -->
    <div id="save-template-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10001] hidden" role="dialog" aria-labelledby="save-template-title" aria-modal="true">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
            <header class="flex items-center justify-between p-6 border-b border-gray-200">
                <h3 id="save-template-title" class="text-lg font-semibold text-gray-900">
                    <i class="fas fa-save text-green-600 mr-2"></i>
                    Sauvegarder le Template
                </h3>
                <button id="close-save-template-modal" class="text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 rounded-md p-1">
                    <i class="fas fa-times"></i>
                </button>
            </header>
            
            <div class="p-6">
                <div class="space-y-4">
                    <div>
                        <label for="template-name" class="block text-sm font-medium text-gray-700 mb-2">
                            Nom du template *
                        </label>
                        <input type="text" id="template-name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Ex: CV Commercial, Layout Moderne..." required>
                    </div>
                    
                    <div>
                        <label for="template-description" class="block text-sm font-medium text-gray-700 mb-2">
                            Description (optionnel)
                        </label>
                        <textarea id="template-description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Décrivez brièvement ce template..."></textarea>
                    </div>
                    
                    <div class="bg-blue-50 border border-blue-200 rounded-md p-3">
                        <h4 class="font-medium text-blue-900 mb-2">Ce qui sera sauvegardé :</h4>
                        <ul class="text-sm text-blue-800 space-y-1">
                            <li>• Layout et disposition des colonnes</li>
                            <li>• Couleurs et styles visuels</li>
                            <li>• Configuration de la bannière</li>
                            <li>• Paramètres de police et espacement</li>
                            <li>• Structure des sections</li>
                        </ul>
                        <p class="text-xs text-blue-700 mt-2 font-medium">Note: Le contenu personnel ne sera pas inclus</p>
                    </div>
                </div>
            </div>
            
            <div class="p-6 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3">
                <button id="cancel-save-template" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2">
                    Annuler
                </button>
                <button id="confirm-save-template" class="px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2">
                    <i class="fas fa-save mr-2"></i>
                    Sauvegarder
                </button>
            </div>
        </div>
    </div>

    <div id="notification"></div>
    
    <div class="flex flex-col lg:flex-row min-h-screen">
        <!-- CONTROLS PANEL -->
        <div id="controls" class="resizable-panel w-full lg:w-1/3 xl:w-1/4 p-6 bg-white shadow-2xl overflow-y-auto flex flex-col no-print transition-panel">
            <!-- Handle de redimensionnement pour le panneau de gauche -->
            <div class="resize-handle resize-handle-right" data-panel="controls"></div>
            
            <div class="flex justify-between items-center mb-4 flex-shrink-0">
                <div class="flex items-center gap-3">
                    <i class="fas fa-magic-wand-sparkles text-3xl text-blue-600"></i>
                    <h1 class="text-2xl font-bold text-gray-800">Créateur de CV</h1>
                    <div id="api-status-indicator" class="flex items-center gap-1">
                        <i id="api-status-icon" class="fas fa-circle text-red-500 text-xs" title="Clé API non configurée"></i>
                        <span id="api-status-text" class="text-xs text-gray-500">IA: OFF</span>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <!-- Save status removed -->
                    <div class="tooltip">
                        <button id="undo-btn" class="history-btn text-xl text-gray-600 hover:text-gray-900 disabled:text-gray-300" title="Annuler (Ctrl+Z)"><i class="fas fa-undo"></i></button>
                        <div class="tooltip-content top">
                            <strong>Annuler (Ctrl+Z)</strong><br>
                            Annule la dernière modification apportée au CV.<br>
                            Permet de revenir en arrière dans l'historique des changements.
                        </div>
                    </div>
                    <div class="tooltip">
                        <button id="redo-btn" class="history-btn text-xl text-gray-600 hover:text-gray-900 disabled:text-gray-300" title="Rétablir (Ctrl+Y)"><i class="fas fa-redo"></i></button>
                        <div class="tooltip-content top">
                            <strong>Rétablir (Ctrl+Y)</strong><br>
                            Rétablit la dernière action annulée.<br>
                            Permet de refaire une modification précédemment annulée.
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- NEW: Progress Bar -->
            <div class="mb-4 flex-shrink-0">
                <label class="text-sm font-medium text-gray-600">Progression</label>
                <div id="progress-bar-container" class="w-full bg-gray-200 rounded-full h-2.5 mt-1">
                    <div id="progress-bar" class="bg-green-500 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
                <p id="progress-text" class="text-xs text-right text-gray-500 mt-1">0/X sections complétées</p>
            </div>

            <!-- NEW: Collapse All Button -->
            <div class="mb-4 flex-shrink-0">
                <div class="tooltip">
                    <button id="collapse-all-btn" class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 px-4 rounded-md flex items-center justify-center gap-2 text-sm font-medium transition-colors duration-200">
                        <i class="fas fa-compress-alt"></i>
                        <span id="collapse-btn-text">Réduire toutes les sections</span>
                    </button>
                    <div class="tooltip-content top">
                        <strong>Réduire/Développer toutes les sections</strong><br>
                        Ferme ou ouvre toutes les sections d'un coup<br>
                        pour une navigation plus facile dans l'interface.
                    </div>
                </div>
            </div>




            <!-- TABS -->
            <div id="tab-navigation" class="flex flex-wrap -mb-px border-b border-gray-200">
                <button class="tab-btn -mb-px py-3 px-4 text-sm font-medium border-b-2 whitespace-nowrap" data-target="#panel-ia"><i class="fa-solid fa-robot mr-1"></i> IA</button>
                <button class="tab-btn -mb-px py-3 px-4 text-sm font-medium border-b-2 whitespace-nowrap" data-target="#panel-content"><i class="fa-solid fa-file-lines mr-1"></i> Contenu</button>
                <button class="tab-btn -mb-px py-3 px-4 text-sm font-medium border-b-2 whitespace-nowrap" data-target="#panel-layout"><i class="fa-solid fa-columns mr-1"></i> Mise en Page</button>
                <button class="tab-btn -mb-px py-3 px-4 text-sm font-medium border-b-2 whitespace-nowrap" data-target="#panel-banner"><i class="fa-solid fa-user-tie mr-1"></i> Bannière</button>
            </div>

            <div id="tab-content" class="py-4 flex-grow overflow-y-auto">
                <!-- TAB: IA -->
                <div id="panel-ia" class="tab-panel space-y-4">
                    <details class="control-group">
                        <summary><span>Analyse IA</span><label class="completion-label"><input type="checkbox" id="completion-ia-analyse" class="completion-checkbox"><span>Fait ✅</span></label></summary>
                        <div class="control-group-content space-y-2">
                            <textarea id="ai-input" rows="6" class="w-full p-2 border rounded-md" placeholder="Collez ici une description de poste, un CV brut..."></textarea>
                            <div class="tooltip">
                                <button id="analyze-btn" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 flex items-center justify-center gap-2"><i class="fa-solid fa-wand-magic-sparkles"></i> Analyser & Remplir</button>
                                <button id="test-fill-btn" class="w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 flex items-center justify-center gap-2 mt-2"><i class="fa-solid fa-bug"></i> Test Remplissage</button>
                                <button id="test-api-btn" class="w-full bg-purple-600 text-white py-2 px-4 rounded-md hover:bg-purple-700 flex items-center justify-center gap-2 mt-2"><i class="fa-solid fa-flask"></i> Test API</button>
                                <div class="tooltip-content top">
                                    <strong>Analyser & Remplir</strong><br>
                                    Utilise l'IA pour analyser le texte saisi et remplir<br>
                                    automatiquement les sections du CV avec les informations<br>
                                    extraites (expériences, formations, compétences...).
                                </div>
                            </div>
                        </div>
                    </details>
                    <details class="control-group">
                        <summary><span>Présentation Recruteur</span><label class="completion-label"><input type="checkbox" id="completion-ia-presentation" class="completion-checkbox"><span>Fait ✅</span></label></summary>
                        <div class="control-group-content space-y-3">
                            <input type="text" id="qualification-dispo" placeholder="Disponibilité" class="cv-input w-full p-2 border rounded-md">
                            <input type="text" id="qualification-salaire" placeholder="Prétentions salariales" class="cv-input w-full p-2 border rounded-md">
                            <input type="text" id="qualification-loc" placeholder="Localisation" class="cv-input w-full p-2 border rounded-md">
                            <div class="tooltip">
                                <button id="generate-mail-btn" class="mt-2 w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 flex items-center justify-center gap-2"><i class="fas fa-wand-magic-sparkles"></i> Générer le mail</button>
                                <div class="tooltip-content top">
                                    <strong>Générer le mail</strong><br>
                                    Crée automatiquement un email de présentation<br>
                                    personnalisé en utilisant les informations du CV<br>
                                    et les critères spécifiés (disponibilité, salaire, localisation).
                                </div>
                            </div>
                            <textarea id="recruiter-mail-content" rows="8" class="cv-input w-full p-2 border rounded-md mt-2" placeholder="Le mail de présentation apparaîtra ici..."></textarea>
                        </div>
                    </details>

                    <!-- Nouvelle section: Optimisation IA -->
                    <details class="control-group">
                        <summary><span>Optimisation IA</span><label class="completion-label"><input type="checkbox" id="completion-ia-optimization" class="completion-checkbox"><span>Fait ✅</span></label></summary>
                        <div class="control-group-content space-y-3">
                            <div class="tooltip">
                                <button id="ai-layout-optimize-btn" class="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 px-4 rounded-md hover:from-purple-700 hover:to-pink-700 flex items-center justify-center gap-2 font-semibold">
                                    <i class="fas fa-magic-wand-sparkles"></i> IA Layout Optimisation
                                </button>
                                <div class="tooltip-content top">
                                    <strong>Optimisation Layout IA - NOUVEAU !</strong><br>
                                    L'IA analyse votre contenu et optimise automatiquement :<br>
                                    • Layout (1 ou 2 colonnes)<br>
                                    • Tailles de polices<br>
                                    • Marges et espacements<br>
                                    • Bannière recruteur<br>
                                    • Tout pour tenir sur 1 page parfaite !
                                </div>
                            </div>
                            <div class="tooltip">
                                <button id="ai-optimize-all-btn" class="w-full bg-purple-600 text-white py-2 px-4 rounded-md hover:bg-purple-700 flex items-center justify-center gap-2">
                                    <i class="fas fa-rocket"></i> Optimiser tout le CV
                                </button>
                                <div class="tooltip-content top">
                                    <strong>Optimisation complète IA</strong><br>
                                    L'IA analyse et améliore l'ensemble du CV :<br>
                                    descriptions, orthographe, structure, pertinence.
                                </div>
                            </div>
                            <div class="tooltip">
                                <button id="ai-rewrite-descriptions-btn" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 flex items-center justify-center gap-2">
                                    <i class="fas fa-pen-fancy"></i> Réécrire les descriptions
                                </button>
                                <div class="tooltip-content top">
                                    <strong>Réécriture IA des descriptions</strong><br>
                                    Reformule toutes les descriptions d'expériences<br>
                                    pour les rendre plus impactantes et professionnelles.
                                </div>
                            </div>
                            <div class="tooltip">
                                <button id="ai-synthesize-experiences-btn" class="w-full bg-teal-600 text-white py-2 px-4 rounded-md hover:bg-teal-700 flex items-center justify-center gap-2">
                                    <i class="fas fa-compress-arrows-alt"></i> Synthétiser les expériences
                                </button>
                                <div class="tooltip-content top">
                                    <strong>Synthèse IA des expériences</strong><br>
                                    Condense automatiquement vos expériences<br>
                                    en gardant l'essentiel (max 5 lignes chacune).
                                </div>
                            </div>
                        </div>
                    </details>

                    <!-- Nouvelle section: IA Créative -->
                    <details class="control-group">
                        <summary><span>IA Créative</span><label class="completion-label"><input type="checkbox" id="completion-ia-creative" class="completion-checkbox"><span>Fait ✅</span></label></summary>
                        <div class="control-group-content space-y-3">
                            <div class="tooltip">
                                <button id="ai-generate-achievements-btn" class="w-full bg-amber-600 text-white py-2 px-4 rounded-md hover:bg-amber-700 flex items-center justify-center gap-2">
                                    <i class="fas fa-trophy"></i> Générer des réalisations
                                </button>
                                <div class="tooltip-content top">
                                    <strong>Générateur de réalisations</strong><br>
                                    L'IA crée des points de réalisation percutants<br>
                                    basés sur vos expériences existantes.
                                </div>
                            </div>
                            <div class="tooltip">
                                <button id="ai-suggest-skills-btn" class="w-full bg-emerald-600 text-white py-2 px-4 rounded-md hover:bg-emerald-700 flex items-center justify-center gap-2">
                                    <i class="fas fa-lightbulb"></i> Suggérer des compétences
                                </button>
                                <div class="tooltip-content top">
                                    <strong>Suggestions de compétences IA</strong><br>
                                    Propose des compétences pertinentes selon votre<br>
                                    profil et les tendances du marché.
                                </div>
                            </div>
                            <div class="tooltip">
                                <button id="ai-improve-profile-btn" class="w-full bg-rose-600 text-white py-2 px-4 rounded-md hover:bg-rose-700 flex items-center justify-center gap-2">
                                    <i class="fas fa-user-graduate"></i> Améliorer le profil
                                </button>
                                <div class="tooltip-content top">
                                    <strong>Amélioration du profil IA</strong><br>
                                    Rédige une description de profil accrocheur<br>
                                    et adapté au poste visé.
                                </div>
                            </div>
                        </div>
                    </details>

                    <!-- Nouvelle section: IA Avancée -->
                    <details class="control-group">
                        <summary><span>IA Avancée</span><label class="completion-label"><input type="checkbox" id="completion-ia-advanced" class="completion-checkbox"><span>Fait ✅</span></label></summary>
                        <div class="control-group-content space-y-3">
                            <div class="grid grid-cols-2 gap-2">
                                <select id="target-sector" class="cv-input p-2 border rounded-md text-sm">
                                    <option value="">Secteur cible</option>
                                    <option value="tech">Tech/IT</option>
                                    <option value="finance">Finance</option>
                                    <option value="marketing">Marketing</option>
                                    <option value="rh">Ressources Humaines</option>
                                    <option value="sante">Santé</option>
                                    <option value="education">Éducation</option>
                                    <option value="commerce">Commerce</option>
                                    <option value="industrie">Industrie</option>
                                </select>
                                <select id="experience-level" class="cv-input p-2 border rounded-md text-sm">
                                    <option value="">Niveau d'expérience</option>
                                    <option value="junior">Junior (0-2 ans)</option>
                                    <option value="intermediate">Intermédiaire (3-5 ans)</option>
                                    <option value="senior">Senior (6-10 ans)</option>
                                    <option value="expert">Expert (10+ ans)</option>
                                </select>
                            </div>
                            <div class="tooltip">
                                <button id="ai-adapt-sector-btn" class="w-full bg-violet-600 text-white py-2 px-4 rounded-md hover:bg-violet-700 flex items-center justify-center gap-2">
                                    <i class="fas fa-target"></i> Adapter au secteur
                                </button>
                                <div class="tooltip-content top">
                                    <strong>Adaptation sectorielle IA</strong><br>
                                    Adapte le vocabulaire et les compétences<br>
                                    au secteur et niveau d'expérience choisis.
                                </div>
                            </div>
                            <div class="tooltip">
                                <button id="ai-keywords-boost-btn" class="w-full bg-cyan-600 text-white py-2 px-4 rounded-md hover:bg-cyan-700 flex items-center justify-center gap-2">
                                    <i class="fas fa-search"></i> Booster les mots-clés
                                </button>
                                <div class="tooltip-content top">
                                    <strong>Optimisation mots-clés IA</strong><br>
                                    Intègre automatiquement les mots-clés<br>
                                    recherchés par les recruteurs de votre secteur.
                                </div>
                            </div>
                        </div>
                    </details>
                </div>

                <!-- TAB: Contenu -->
                <div id="panel-content" class="tab-panel hidden space-y-4">
                    <!-- Informations Personnelles -->
                    <details class="control-group">
                        <summary><span>Informations Personnelles</span><label class="completion-label"><input type="checkbox" id="completion-content-infos" class="completion-checkbox"><span>Fait ✅</span></label></summary>
                        <div class="control-group-content space-y-3">
                            <div class="grid grid-cols-2 gap-3">
                                <input type="text" id="nom" placeholder="Nom" class="cv-input w-full p-2 border rounded-md">
                                <input type="text" id="prenom" placeholder="Prénom" class="cv-input w-full p-2 border rounded-md">
                            </div>
                            <input type="text" id="poste" placeholder="Poste recherché" class="cv-input w-full p-2 border rounded-md">
                            <div class="grid grid-cols-2 gap-3">
                                <input type="email" id="email" placeholder="Email" class="cv-input w-full p-2 border rounded-md">
                                <input type="tel" id="telephone" placeholder="Téléphone" class="cv-input w-full p-2 border rounded-md">
                            </div>
                            <div class="grid grid-cols-3 gap-3">
                                <input type="text" id="adresse" placeholder="Adresse" class="cv-input w-full p-2 border rounded-md">
                                <input type="text" id="ville" placeholder="Ville" class="cv-input w-full p-2 border rounded-md">
                                <input type="text" id="code_postal" placeholder="Code postal" class="cv-input w-full p-2 border rounded-md">
                            </div>
                            <div class="grid grid-cols-2 gap-3">
                                <input type="date" id="date_naissance" placeholder="Date de naissance" class="cv-input w-full p-2 border rounded-md">
                                <input type="text" id="nationalite" placeholder="Nationalité" class="cv-input w-full p-2 border rounded-md">
                            </div>
                            <div class="grid grid-cols-2 gap-3">
                                <input type="text" id="linkedin" placeholder="LinkedIn" class="cv-input w-full p-2 border rounded-md">
                                <input type="text" id="site_web" placeholder="Site web" class="cv-input w-full p-2 border rounded-md">
                            </div>
                            <textarea id="description" placeholder="Description du profil / Objectif professionnel" rows="4" class="cv-input w-full p-2 border rounded-md"></textarea>
                        </div>
                    </details>

                    <!-- Expériences Professionnelles -->
                    <details class="control-group">
                        <summary><span>Expériences Professionnelles</span><label class="completion-label"><input type="checkbox" id="completion-content-exp" class="completion-checkbox"><span>Fait ✅</span></label></summary>
                        <div class="control-group-content space-y-2">
                            <div class="flex justify-end mb-2">
                                <div class="tooltip">
                                    <button id="add-experience" class="text-sm text-blue-600 hover:text-blue-800 font-medium"><i class="fas fa-circle-plus"></i> Ajouter une expérience</button>
                                    <div class="tooltip-content top">
                                        <strong>Ajouter une expérience</strong><br>
                                        Ajoute un nouveau bloc d'expérience professionnelle<br>
                                        avec des champs pour le poste, l'entreprise, les dates<br>
                                        et la description des missions accomplies.
                                    </div>
                                </div>
                            </div>
                            <div id="experience-list" class="space-y-2"></div>
                        </div>
                    </details>

                    <!-- Formations et Éducation -->
                    <details class="control-group">
                        <summary><span>Formations et Éducation</span><label class="completion-label"><input type="checkbox" id="completion-content-form" class="completion-checkbox"><span>Fait ✅</span></label></summary>
                        <div class="control-group-content space-y-2">
                            <div class="flex justify-end mb-2">
                                <div class="tooltip">
                                    <button id="add-formation" class="text-sm text-blue-600 hover:text-blue-800 font-medium"><i class="fas fa-circle-plus"></i> Ajouter une formation</button>
                                    <div class="tooltip-content top">
                                        <strong>Ajouter une formation</strong><br>
                                        Ajoute un nouveau bloc de formation/éducation<br>
                                        avec des champs pour le diplôme, l'établissement,<br>
                                        les dates et les détails de la formation.
                                    </div>
                                </div>
                            </div>
                            <div id="formation-list" class="space-y-2"></div>
                        </div>
                    </details>

                    <!-- Compétences -->
                    <details class="control-group">
                        <summary><span>Compétences</span><label class="completion-label"><input type="checkbox" id="completion-skills" class="completion-checkbox"><span>Fait ✅</span></label></summary>
                        <div class="control-group-content space-y-3">
                            <p class="text-sm font-medium">Style de Présentation</p>
                            <div class="flex gap-2">
                                <button data-skill-style="tags" class="skill-style-btn flex-1 bg-gray-200 p-2 rounded-md text-sm active">Tags</button>
                                <button data-skill-style="levels" class="skill-style-btn flex-1 bg-gray-200 p-2 rounded-md text-sm">Niveaux</button>
                                <button data-skill-style="simple" class="skill-style-btn flex-1 bg-gray-200 p-2 rounded-md text-sm">Simple</button>
                            </div>
                            
                            <div id="skills-text-controls">
                                <div class="flex justify-between items-center"><label for="competences" class="font-medium">Liste des compétences</label><div class="flex gap-2">
                                    <div class="tooltip">
                                        <button id="ai-limit-skills-btn" class="text-blue-600 hover:text-blue-800" title="Limiter à 10 compétences par l'IA"><i class="fas fa-filter"></i> 10</button>
                                        <div class="tooltip-content top">
                                            <strong>Limiter à 10 compétences (IA)</strong><br>
                                            Utilise l'IA pour sélectionner automatiquement<br>
                                            les 10 compétences les plus pertinentes et<br>
                                            supprimer les autres pour un CV plus focalisé.
                                        </div>
                                    </div>
                                    <div class="tooltip">
                                        <button id="ai-synthesize-skills-btn" class="text-blue-600 hover:text-blue-800" title="Synthétiser et ranger les compétences par l'IA"><i class="fas fa-brain"></i></button>
                                        <div class="tooltip-content top">
                                            <strong>Synthétiser et organiser (IA)</strong><br>
                                            L'IA analyse vos compétences, supprime les doublons,<br>
                                            les regroupe par catégories et les réorganise<br>
                                            de manière logique et professionnelle.
                                        </div>
                                    </div>
                                </div></div>
                                <textarea id="competences" placeholder="Compétences (séparées par des virgules)..." rows="4" class="cv-input w-full p-2 border rounded-md"></textarea>
                            </div>

                            <div id="skills-level-controls" class="hidden space-y-3">
                                <p class="text-sm font-medium">Style de Jauge</p>
                                <div class="grid grid-cols-5 gap-2 text-center">
                                    <button data-gauge-style="bar" class="gauge-style-btn bg-gray-200 p-2 rounded-md text-sm active" title="Barre"><i class="fas fa-bars"></i></button>
                                    <button data-gauge-style="dots" class="gauge-style-btn bg-gray-200 p-2 rounded-md text-sm" title="Points"><i class="fas fa-circle"></i></button>
                                    <button data-gauge-style="stars" class="gauge-style-btn bg-gray-200 p-2 rou